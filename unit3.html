<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Math is Fun: Master Barista</title>

  <!-- Libraries -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Tailwind Config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Fredoka', 'sans-serif'] },
          colors: {
            anime: {
              purple: '#D8B4FE',
              purpleDark: '#A855F7',
              pink: '#FDB4D1',
              pinkDark: '#EC4899',
              blue: '#BAE6FD',
              blueDark: '#0EA5E9',
              bg: '#FDFBF7',
            }
          },
          boxShadow: {
            'anime': '0 4px 0px 0px rgba(0,0,0,0.1)',
            'anime-hover': '0 6px 0px 0px rgba(0,0,0,0.15)',
          }
        }
      }
    }
  </script>

  <style>
    body{
      background-color:#FDFBF7;
      background-image:radial-gradient(#e5e7eb 1px, transparent 1px);
      background-size:20px 20px;
    }
    .btn-3d,.btn-anime{
      transition:all .1s ease-in-out;
      border-bottom-width:4px;
    }
    .btn-3d:active,.btn-anime:active{
      border-bottom-width:0px;
      transform:translateY(4px);
      margin-bottom:4px;
    }
    .btn-3d:disabled{
      opacity:.6;
      cursor:not-allowed;
      transform:none;
      border-bottom-width:0;
      background-color:#cbd5e1;
      border-color:#94a3b8;
      color:#64748b;
    }
    input[type=range]{-webkit-appearance:none;width:100%;background:transparent;}
    input[type=range]::-webkit-slider-thumb{
      -webkit-appearance:none;height:24px;width:24px;border-radius:50%;
      background:#fff;border:3px solid currentColor;cursor:pointer;margin-top:-10px;
      box-shadow:0 4px 0 rgba(0,0,0,.1);transition:transform .1s;
    }
    input[type=range]::-webkit-slider-thumb:hover{transform:scale(1.1);}
    input[type=range]::-webkit-slider-runnable-track{width:100%;height:6px;cursor:pointer;background:#e2e8f0;border-radius:10px;}
    .option-selected{
      background-color:#F0ABFC !important;
      border-color:#C026D3 !important;
      color:#fff !important;
      transform:translateY(2px);
      border-bottom-width:0px !important;
    }
    .pop-in{animation:popIn .3s cubic-bezier(.175,.885,.32,1.275);}
    @keyframes popIn{0%{transform:scale(.8);opacity:0}100%{transform:scale(1);opacity:1}}
    .progress-step{transition:all .3s ease;}
    .progress-line{transition:width .5s cubic-bezier(.4,0,.2,1);}
  </style>
</head>

<body class="min-h-screen flex flex-col text-slate-700 pb-10">

  <!-- Header -->
  <header class="bg-white border-b-4 border-anime-purple/20 py-3 px-4 sticky top-0 z-50 shadow-sm">
    <div class="max-w-7xl mx-auto flex justify-between items-center">
      <div class="flex items-center gap-3">
        <div class="bg-anime-purple text-white p-2 rounded-xl rotate-3 shadow-sm">
          <i class="fa-solid fa-mug-hot text-lg w-6 h-6 flex items-center justify-center"></i>
        </div>
        <div>
          <h1 class="text-xl md:text-2xl font-bold text-gray-800 leading-none">Unit 3: MASTER BARISTA</h1>
          <p class="text-xs text-anime-purple font-medium bg-anime-purple/10 px-2 py-0.5 rounded-full inline-block mt-1">
            Math is Fun!
          </p>
        </div>
      </div>

      <button onclick="resetSim()" class="btn-anime bg-rose-400 hover:bg-rose-500 text-white border-rose-600 px-4 py-2 rounded-xl text-sm font-bold shadow-md flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
        </svg>
        <span class="hidden sm:inline">Mula Semula</span>
      </button>
    </div>
  </header>

  <!-- Layout -->
  <div class="max-w-7xl mx-auto w-full p-4 md:p-6 grid grid-cols-1 lg:grid-cols-12 gap-6 md:gap-8 items-start">

    <!-- LEFT: Stimulus -->
    <div class="lg:col-span-7 flex flex-col gap-6">

      <div class="bg-white p-6 rounded-3xl shadow-anime border-2 border-slate-100 flex items-start gap-5 transform hover:scale-[1.01] transition duration-300">
        <div class="bg-anime-blue p-4 rounded-2xl text-white text-xl shrink-0 shadow-sm border-b-4 border-anime-blueDark hidden md:block">
          <i class="fa-solid fa-scroll"></i>
        </div>
        <div>
          <h2 class="font-bold text-xl text-slate-800 mb-1 flex items-center gap-2">
            <span class="md:hidden bg-anime-blue p-1.5 rounded text-white text-sm"><i class="fa-solid fa-scroll"></i></span>
            Misi Anda: Formula 'House Blend' Terbaik!
          </h2>
          <p class="text-slate-600 leading-relaxed font-medium">
            Selamat datang, Barista Muda! Sebagai Ketua Barista, anda perlu mencipta resepi kopi yang seimbang menggunakan tiga bahan utama.
            Gunakan alat kawalan untuk melaraskan nisbah
            <span class="text-amber-500 font-bold">Sirap</span>,
            <span class="text-slate-400 font-bold">Susu</span>,
            dan <span class="text-amber-900 font-bold">Kopi</span>.
          </p>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

        <!-- Cup -->
        <div class="bg-white rounded-3xl shadow-anime border-2 border-slate-100 p-8 flex justify-center items-end h-[420px] relative overflow-hidden">
          <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#6366f1 2px, transparent 2px); background-size: 20px 20px;"></div>

          <svg width="180" height="300" viewBox="0 0 200 300" class="z-10 drop-shadow-2xl">
            <clipPath id="cupClip">
              <path d="M10,0 L35,260 Q40,300 100,300 Q160,300 165,260 L190,0 Z" />
            </clipPath>

            <g clip-path="url(#cupClip)">
              <rect x="0" y="0" width="200" height="300" fill="#f1f5f9" />
              <rect id="visSyrup" x="0" y="280" width="200" height="0" fill="#FBBF24" opacity="0.9" />
              <rect id="visMilk" x="0" y="280" width="200" height="0" fill="#FFF7ED" />
              <rect id="visCoffee" x="0" y="280" width="200" height="0" fill="#5D4037" opacity="0.95" />
            </g>

            <path d="M10,0 L35,260 Q40,300 100,300 Q160,300 165,260 L190,0"
              fill="none" stroke="#cbd5e1" stroke-width="4" stroke-linecap="round" />
          </svg>

          <div class="absolute top-4 left-4 bg-white/90 backdrop-blur px-3 py-2 rounded-xl shadow-sm border border-slate-100">
            <div class="flex flex-col gap-1 text-xs font-bold">
              <span class="text-amber-500 flex items-center"><div class="w-3 h-3 rounded-full bg-amber-400 mr-2"></div>Sirap</span>
              <span class="text-slate-400 flex items-center"><div class="w-3 h-3 rounded-full bg-orange-50 border border-slate-200 mr-2"></div>Susu</span>
              <span class="text-amber-900 flex items-center"><div class="w-3 h-3 rounded-full bg-amber-900 mr-2"></div>Kopi</span>
            </div>
          </div>
        </div>

        <!-- Controls -->
        <div class="flex flex-col gap-6">

          <div class="bg-white p-6 rounded-3xl shadow-anime border-2 border-slate-100">
            <h3 class="text-sm font-bold text-slate-400 uppercase tracking-widest mb-6 text-center bg-slate-50 py-2 rounded-lg">
              Panel Ramuan (ml)
            </h3>

            <div class="mb-6">
              <div class="flex justify-between mb-2 items-center">
                <label class="text-md font-bold text-amber-900"><i class="fa-solid fa-mug-hot mr-1"></i> Kopi</label>
                <span class="text-sm font-bold text-white bg-amber-900 px-3 py-1 rounded-full shadow-sm" id="valCoffee">40 ml</span>
              </div>
              <input type="range" id="sliderCoffee" min="0" max="100" value="40" step="10" class="accent-amber-900">
            </div>

            <div class="mb-6">
              <div class="flex justify-between mb-2 items-center">
                <label class="text-md font-bold text-slate-500"><i class="fa-solid fa-bottle-droplet mr-1"></i> Susu</label>
                <span class="text-sm font-bold text-white bg-slate-400 px-3 py-1 rounded-full shadow-sm" id="valMilk">80 ml</span>
              </div>
              <input type="range" id="sliderMilk" min="0" max="200" value="80" step="10" class="accent-slate-400">
            </div>

            <div class="mb-2">
              <div class="flex justify-between mb-2 items-center">
                <label class="text-md font-bold text-amber-500"><i class="fa-solid fa-droplet mr-1"></i> Sirap</label>
                <span class="text-sm font-bold text-white bg-amber-500 px-3 py-1 rounded-full shadow-sm" id="valSyrup">20 ml</span>
              </div>
              <input type="range" id="sliderSyrup" min="0" max="50" value="20" step="5" class="accent-amber-500">
            </div>
          </div>

          <div class="bg-slate-800 text-white p-6 rounded-3xl shadow-anime border-b-8 border-slate-900 relative overflow-hidden">
            <div class="absolute -right-6 -top-6 bg-white/10 w-24 h-24 rounded-full blur-2xl"></div>
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4 border-b border-slate-700 pb-2">
              Analisis Resipi
            </h3>
            <div class="grid grid-cols-2 gap-4">
              <div class="bg-slate-700/50 p-3 rounded-xl">
                <span class="text-xs text-slate-400 block mb-1">Jumlah Isipadu</span>
                <span class="text-2xl font-bold text-anime-blue" id="totalVol">140</span> <span class="text-xs font-bold">ml</span>
              </div>
              <div class="bg-slate-700/50 p-3 rounded-xl">
                <span class="text-xs text-slate-400 block mb-1">Anggaran Kos</span>
                <span class="text-xs font-bold">RM</span> <span class="text-2xl font-bold text-anime-pink" id="totalCost">0.00</span>
              </div>
            </div>
            <div class="mt-4 bg-slate-900/50 p-3 rounded-xl flex justify-between items-center">
              <span class="text-xs text-slate-400">Nisbah (K:S:P)</span>
              <span class="text-lg font-mono text-yellow-300 tracking-wider font-bold" id="ratioDisplay">40 : 80 : 20</span>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- RIGHT: Quiz -->
    <div class="lg:col-span-5 lg:sticky lg:top-24 h-fit" id="quiz-card">
      <div class="bg-white rounded-3xl shadow-2xl border-2 border-slate-100 overflow-hidden flex flex-col min-h-[750px]">

        <!-- Header progress -->
        <div class="p-6 pb-6 border-b border-gray-100 bg-white z-20">
          <div class="flex justify-between items-end mb-4">
            <span class="text-xs font-bold text-gray-400 uppercase tracking-wider">Cabaran Minda</span>
            <span id="domain-badge" class="bg-teal-100 text-teal-700 text-[10px] font-bold px-2 py-1 rounded-lg shadow-sm uppercase">
              Mengetahui
            </span>
          </div>

          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-800">Item <span id="current-q-num" class="text-anime-purpleDark">1</span></h2>
            <span class="text-xs font-bold text-anime-purpleDark bg-purple-50 px-2 py-1 rounded-full">
              Kemajuan: <span id="progress-percent">0</span>%
            </span>
          </div>

          <div class="relative pt-1">
            <div class="flex mb-2 items-center justify-between relative">
              <div class="absolute left-0 top-1/2 transform -translate-y-1/2 w-full h-1.5 bg-gray-100 rounded-full z-0"></div>
              <div id="progress-line" class="absolute left-0 top-1/2 transform -translate-y-1/2 h-1.5 bg-gradient-to-r from-anime-purple to-anime-pink rounded-full z-10 progress-line" style="width:0%"></div>
              <div class="relative z-20 flex justify-between w-full">
                <div id="marker-1" class="w-6 h-6 rounded-full bg-anime-purple text-white text-[10px] font-bold flex items-center justify-center border-2 border-white shadow-md progress-step">1</div>
                <div id="marker-2" class="w-6 h-6 rounded-full bg-white text-gray-400 text-[10px] font-bold flex items-center justify-center border-2 border-gray-100 shadow-sm progress-step">2</div>
                <div id="marker-3" class="w-6 h-6 rounded-full bg-white text-gray-400 text-[10px] font-bold flex items-center justify-center border-2 border-gray-100 shadow-sm progress-step">3</div>
                <div id="marker-4" class="w-6 h-6 rounded-full bg-white text-gray-400 text-[10px] font-bold flex items-center justify-center border-2 border-gray-100 shadow-sm progress-step">4</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Content -->
        <div class="p-6 md:p-8 flex-1 bg-white">

          <!-- Q1 -->
          <div id="q1" class="question-block pop-in">
            <div class="mb-6">
              <h3 class="text-xl font-bold text-slate-900 mb-4 bg-yellow-50 p-3 rounded-2xl border-2 border-yellow-100 inline-block">
                Menentukan Nisbah Termudah
              </h3>
              <p class="text-slate-600 font-medium leading-relaxed mb-4">Laraskan slider kepada nilai berikut:</p>
              <ul class="list-disc list-inside text-sm text-slate-700 mt-2 bg-slate-50 p-4 rounded-2xl border border-slate-200 font-bold space-y-1">
                <li>Kopi: <span class="text-amber-900">40 ml</span></li>
                <li>Susu: <span class="text-slate-500">80 ml</span></li>
                <li>Sirap: <span class="text-amber-600">20 ml</span></li>
              </ul>
              <p class="text-slate-800 text-lg font-bold mt-6">Apakah nisbah termudah bagi Kopi : Susu : Sirap?</p>
            </div>
            <div class="space-y-4">
              <button onclick="selectOption(1,'A',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-anime-purple bg-white text-slate-600 font-bold text-lg flex items-center">
                <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center mr-4 text-slate-400">A</div> 4 : 8 : 2
              </button>
              <button onclick="selectOption(1,'B',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-anime-purple bg-white text-slate-600 font-bold text-lg flex items-center">
                <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center mr-4 text-slate-400">B</div> 2 : 4 : 1
              </button>
              <button onclick="selectOption(1,'C',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-anime-purple bg-white text-slate-600 font-bold text-lg flex items-center">
                <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center mr-4 text-slate-400">C</div> 1 : 4 : 2
              </button>
              <button onclick="selectOption(1,'D',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-anime-purple bg-white text-slate-600 font-bold text-lg flex items-center">
                <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center mr-4 text-slate-400">D</div> 20 : 40 : 10
              </button>
            </div>
          </div>

          <!-- Q2 -->
          <div id="q2" class="question-block hidden pop-in">
            <div class="mb-6">
              <h3 class="text-xl font-bold text-slate-900 mb-4 bg-blue-50 p-3 rounded-2xl border-2 border-blue-100 inline-block">
                Mengira Kos Pesanan Besar
              </h3>
              <p class="text-slate-600 font-medium mb-4">Kafe anda menerima tempahan katering untuk <strong>50 cawan</strong> minuman.</p>
              <div class="bg-blue-50 p-5 rounded-2xl border-2 border-blue-100 text-sm mb-6 shadow-sm">
                <p class="font-bold text-blue-900 mb-2 uppercase tracking-wide">Resipi Satu Cawan:</p>
                <ul class="list-none space-y-2 text-slate-700 font-bold">
                  <li class="flex justify-between"><span>Kopi</span><span>50 ml</span></li>
                  <li class="flex justify-between border-y border-blue-100 py-1"><span>Susu</span><span>100 ml</span></li>
                  <li class="flex justify-between"><span>Sirap</span><span>30 ml</span></li>
                </ul>
              </div>
              <p class="text-slate-800 text-lg font-bold">Hitung jumlah kos bahan untuk 50 cawan tersebut.</p>
            </div>
            <div class="space-y-4">
              <button onclick="selectOption(2,'A',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-anime-blue bg-white text-slate-600 font-bold">RM 415.00</button>
              <button onclick="selectOption(2,'B',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-anime-blue bg-white text-slate-600 font-bold">RM 420.50</button>
              <button onclick="selectOption(2,'C',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-anime-blue bg-white text-slate-600 font-bold">RM 425.00</button>
              <button onclick="selectOption(2,'D',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-anime-blue bg-white text-slate-600 font-bold">RM 435.00</button>
            </div>
          </div>

          <!-- Q3 -->
          <div id="q3" class="question-block hidden pop-in">
            <div class="mb-6">
              <h3 class="text-xl font-bold text-slate-900 mb-4 bg-green-50 p-3 rounded-2xl border-2 border-green-100 inline-block">
                Analisis Peratusan (Konsep Pencairan)
              </h3>
              <div class="bg-green-50 border-2 border-green-100 p-5 rounded-2xl mb-6">
                <ol class="list-decimal list-inside space-y-3 text-slate-700 font-medium text-sm">
                  <li class="bg-white p-3 rounded-xl shadow-sm leading-relaxed"><strong>Situasi Awal:</strong> Satu cawan minuman 200 ml mengandungi 50 ml Kopi (25%).</li>
                  <li class="bg-white p-3 rounded-xl shadow-sm leading-relaxed"><strong>Tindakan:</strong> Anda menambah 50 ml Sirap lagi.</li>
                  <li class="bg-white p-3 rounded-xl shadow-sm leading-relaxed"><strong>Situasi Akhir:</strong> Isipadu jadi 250 ml, tetapi Kopi kekal 50 ml.</li>
                </ol>
              </div>
              <p class="text-slate-800 text-lg font-bold">Berapakah peratusan kandungan Kopi dalam campuran baharu (250 ml) ini?</p>
            </div>
            <div class="space-y-4">
              <button onclick="selectOption(3,'A',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-green-400 bg-white text-slate-600 font-bold">A. 25% (Tiada perubahan)</button>
              <button onclick="selectOption(3,'B',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-green-400 bg-white text-slate-600 font-bold">B. 20% (Berkurang)</button>
              <button onclick="selectOption(3,'C',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-green-400 bg-white text-slate-600 font-bold">C. 10% (Separuh)</button>
              <button onclick="selectOption(3,'D',this)" class="btn-3d w-full text-left p-5 rounded-2xl border-2 border-slate-200 hover:border-green-400 bg-white text-slate-600 font-bold">D. 30% (Bertambah)</button>
            </div>
          </div>

          <!-- Q4 -->
          <div id="q4" class="question-block hidden pop-in">
            <div class="mb-4">
              <h3 class="text-xl font-bold text-slate-900 mb-4 bg-purple-100 p-3 rounded-2xl border-2 border-purple-200 text-purple-700 inline-block">
                Misi: Misteri Resipi Hilang
              </h3>

              <div class="bg-white p-5 rounded-3xl shadow-sm border-2 border-dashed border-slate-300 relative mb-6">
                <i class="fa-solid fa-thumbtack text-red-400 absolute -top-3 left-1/2 text-xl"></i>
                <h4 class="font-bold text-slate-400 text-xs uppercase mb-3 text-center tracking-widest">Nota Terkoyak</h4>
                <ul class="text-sm space-y-4 text-slate-700 font-bold">
                  <li class="flex items-start gap-3"><div class="w-6 h-6 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs shrink-0">1</div>
                    <span>Nisbah Kopi : Susu mestilah <span class="text-purple-600 text-lg underline">1 : 2</span></span></li>
                  <li class="flex items-start gap-3"><div class="w-6 h-6 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs shrink-0">2</div>
                    <span>Kos campuran Kopi dan Susu ini tepat <span class="text-green-600 text-lg underline">RM 3.30</span></span></li>
                  <li class="flex items-start gap-3"><div class="w-6 h-6 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs shrink-0">3</div>
                    <span>Tambah Sirap sehingga isipadu jadi <span class="text-blue-500 text-lg underline">130 ml</span></span></li>
                </ul>
              </div>

              <div class="bg-yellow-50 p-4 rounded-2xl border-2 border-yellow-100 text-sm text-yellow-800 italic mb-6 shadow-sm">
                <i class="fa-solid fa-lightbulb mr-2"></i><strong>Petunjuk:</strong> Gunakan slider di kiri untuk mencari dahulu berapa ml Kopi & Susu yang menepati syarat 1 dan 2.
              </div>

              <div class="bg-slate-50 p-6 rounded-3xl border-2 border-slate-200">
                <p class="text-slate-800 font-bold mb-6 text-center text-lg uppercase tracking-tight">Selesaikan Misteri:</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label class="text-xs font-bold text-slate-400 block mb-2 uppercase tracking-wide">Kuantiti Sirap (ml)</label>
                    <input type="number" id="ans-sirap" class="w-full bg-white border-2 border-slate-200 rounded-2xl py-4 px-3 text-center font-bold text-xl text-slate-800 focus:outline-none focus:border-anime-purple" placeholder="0">
                  </div>
                  <div>
                    <label class="text-xs font-bold text-slate-400 block mb-2 uppercase tracking-wide">Kos Akhir (RM)</label>
                    <input type="number" id="ans-cost" class="w-full bg-white border-2 border-slate-200 rounded-2xl py-4 px-3 text-center font-bold text-xl text-green-600 focus:outline-none focus:border-anime-purple" placeholder="0.00" step="0.01">
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- End -->
          <div id="endScreen" class="hidden flex flex-col items-center justify-center py-10 pop-in text-center h-full">
            <div class="w-32 h-32 bg-green-100 rounded-full flex items-center justify-center text-green-500 text-6xl mb-8 shadow-anime animate-bounce border-4 border-white">
              <i class="fa-solid fa-trophy"></i>
            </div>
            <h2 class="text-4xl font-bold text-slate-800 mb-4 tracking-tight">TAHNIAH!</h2>
            <p class="text-slate-500 font-medium text-xl mb-10 leading-relaxed">
              Anda telah berjaya melengkapkan misi Master Barista dengan cemerlang!
            </p>
            <button onclick="location.reload()" class="btn-3d px-12 py-5 bg-anime-purple text-white rounded-3xl font-bold border-anime-purpleDark shadow-lg text-xl">
              Main Semula
            </button>
          </div>
        </div>

        <!-- Footer nav -->
        <div class="p-6 border-t-2 border-slate-100 bg-white flex justify-between items-center z-30 shrink-0" id="navFooter">
          <button id="prevBtn" onclick="navigate(-1)" disabled
            class="btn-3d px-6 py-3 bg-white text-slate-600 border-slate-300 rounded-xl font-bold shadow-md flex items-center transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base hover:bg-slate-50">
            <i class="fa-solid fa-chevron-left mr-2"></i> Kembali
          </button>

          <button id="nextBtn" onclick="navigate(1)" disabled
            class="btn-3d px-6 py-3 bg-anime-blue text-blue-900 border-anime-blueDark rounded-xl font-bold shadow-md flex items-center transition-all disabled:opacity-50 text-sm md:text-base">
            Seterusnya <i class="fa-solid fa-chevron-right ml-2"></i>
          </button>

          <button id="finishBtn" onclick="submitQuiz()" class="hidden btn-3d px-6 py-3 bg-green-500 text-white border-green-700 rounded-xl font-bold shadow-md flex items-center transition-all hover:bg-green-600 text-sm md:text-base" disabled>
            Hantar <i class="fa-solid fa-paper-plane ml-2"></i>
          </button>
        </div>

      </div>
    </div>
  </div>

  <script>
    const resetSim = () => location.reload();

    // ========= SIMULASI =========
    const RATES = { coffee: 0.05, milk: 0.03, syrup: 0.10 };
    const sliderCoffee = document.getElementById('sliderCoffee');
    const sliderMilk = document.getElementById('sliderMilk');
    const sliderSyrup = document.getElementById('sliderSyrup');

    function updateStimulus() {
      const c = parseInt(sliderCoffee.value || "0", 10);
      const m = parseInt(sliderMilk.value || "0", 10);
      const s = parseInt(sliderSyrup.value || "0", 10);

      document.getElementById('valCoffee').innerText = c + " ml";
      document.getElementById('valMilk').innerText = m + " ml";
      document.getElementById('valSyrup').innerText = s + " ml";

      const total = c + m + s;
      const cost = (c * RATES.coffee) + (m * RATES.milk) + (s * RATES.syrup);

      document.getElementById('totalVol').innerText = total;
      document.getElementById('totalCost').innerText = cost.toFixed(2);
      document.getElementById('ratioDisplay').innerText = `${c} : ${m} : ${s}`;

      const MAX_HEIGHT = 260;
      const MAX_VOL = 350;
      const scale = MAX_HEIGHT / MAX_VOL;

      const syrupH = s * scale;
      const milkH = m * scale;
      const coffeeH = c * scale;

      document.getElementById('visSyrup').setAttribute('height', syrupH);
      document.getElementById('visSyrup').setAttribute('y', 280 - syrupH);

      document.getElementById('visMilk').setAttribute('height', milkH);
      document.getElementById('visMilk').setAttribute('y', 280 - syrupH - milkH);

      document.getElementById('visCoffee').setAttribute('height', coffeeH);
      document.getElementById('visCoffee').setAttribute('y', 280 - syrupH - milkH - coffeeH);
    }

    [sliderCoffee, sliderMilk, sliderSyrup].forEach(el => el.addEventListener('input', updateStimulus));
    updateStimulus();

    // ========= KUIZ =========
    let currentQ = 1;
    const totalQ = 4;
    const answers = {}; // {1:'B',2:'C',3:'A',4:true}

    function updateProgressBar() {
      const progressLine = document.getElementById('progress-line');
      const progressPercentText = document.getElementById('progress-percent');

      const percentage = ((currentQ - 1) / (totalQ - 1)) * 100;
      progressLine.style.width = `${percentage}%`;
      progressPercentText.innerText = Math.round(percentage);

      for (let i = 1; i <= totalQ; i++) {
        const marker = document.getElementById(`marker-${i}`);
        if (i < currentQ) {
          marker.classList.remove('bg-white', 'text-gray-400', 'border-gray-100', 'bg-anime-purple');
          marker.classList.add('bg-green-400', 'text-white', 'border-white', 'scale-90');
          marker.innerHTML = '<i class="fa-solid fa-check"></i>';
        } else if (i === currentQ) {
          marker.classList.remove('bg-white', 'text-gray-400', 'border-gray-100', 'bg-green-400');
          marker.classList.add('bg-anime-purple', 'text-white', 'border-white', 'scale-110');
          marker.innerHTML = i;
        } else {
          marker.classList.remove('bg-anime-purple', 'text-white', 'border-white', 'scale-110', 'bg-green-400', 'scale-90');
          marker.classList.add('bg-white', 'text-gray-400', 'border-gray-100');
          marker.innerHTML = i;
        }
      }
    }

    function checkInputQ4() {
      const v1 = (document.getElementById('ans-sirap').value || "").trim();
      const v2 = (document.getElementById('ans-cost').value || "").trim();
      const finishBtn = document.getElementById('finishBtn');

      const ok = (v1 !== "" && v2 !== "");
      answers[4] = ok;
      finishBtn.disabled = !ok;
    }

    function updateNavUI() {
      document.getElementById('current-q-num').innerText = currentQ;
      const tags = ["Mengetahui", "Mengaplikasi", "Menaakul", "Penyelesaian Masalah"];
      document.getElementById('domain-badge').innerText = tags[currentQ - 1];

      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const finishBtn = document.getElementById('finishBtn');

      prevBtn.disabled = (currentQ === 1);

      if (currentQ === totalQ) {
        nextBtn.classList.add('hidden');
        finishBtn.classList.remove('hidden');
        checkInputQ4(); // set finish disabled/enabled
      } else {
        nextBtn.classList.remove('hidden');
        finishBtn.classList.add('hidden');
        nextBtn.disabled = !answers[currentQ];
      }

      updateProgressBar();
    }

    function navigate(direction) {
      const nextQ = currentQ + direction;
      if (nextQ < 1 || nextQ > totalQ) return;

      document.getElementById(`q${currentQ}`).classList.add('hidden');
      currentQ = nextQ;
      document.getElementById(`q${currentQ}`).classList.remove('hidden');

      updateNavUI();

      if (window.innerWidth < 1024) {
        document.getElementById('quiz-card').scrollIntoView({ behavior: "smooth", block: "start" });
      }
    }

    function selectOption(qIndex, optionId, btnElement) {
      const parent = document.getElementById(`q${qIndex}`);
      parent.querySelectorAll('button').forEach(b => b.classList.remove('option-selected'));
      btnElement.classList.add('option-selected');

      answers[qIndex] = optionId;

      // Jangan paksa enable next; ikut state soalan semasa
      updateNavUI();
    }

    // Event Q4
    document.getElementById('ans-sirap').addEventListener('input', checkInputQ4);
    document.getElementById('ans-cost').addEventListener('input', checkInputQ4);

    function submitQuiz() {
      // Tamat sahaja (boleh tambah semakan markah jika mahu)
      document.getElementById(`q${currentQ}`).classList.add('hidden');
      document.getElementById('navFooter').classList.add('hidden');
      document.getElementById('endScreen').classList.remove('hidden');
    }

    // init
    updateNavUI();
  </script>
</body>
</html>
